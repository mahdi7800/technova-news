<?phpadd_action( 'wp_ajax_nopriv_tnw_signup', 'tnw_signup' );function tnw_signup() {	if ( ! isset( $_POST['nonce'] ) && ! wp_verify_nonce( $_POST['nonce'] ) ) {		die( 'access deind' );	}	$email       = sanitize_text_field( $_POST['email'] );	$password    = sanitize_text_field( $_POST['password'] );	$remember_me = isset($_POST['remember_me']) && $_POST['remember_me'] === 'true';	tnw_signup_validate( $email, $password );	$user = get_user_by( 'email', $email );	if ( ! $user ) {		wp_send_json( [ 'error' => true, 'message' => 'کاربری با این ایمیل وجود ندارد!' ], 403 );	}	$cred  = [		'user_login'    => $user->user_login,		'user_password' => $password,		'remember'      => $remember_me	];	$login = wp_signon( $cred );	if (!is_wp_error($login)){		wp_send_json(  ['success'=>true,'redirect_url' => site_url(),'message' => 'ورود شما موفقیت آمیز بود. در حال انتقال...'], 200 );	}else{		wp_send_json( [ 'error' => true, 'message' => 'ایمیل یا کلمه عبور اشتباه است!' ], 403 );	}}// Validatefunction tnw_signup_validate( $email, $password ) {	if ( empty( $email ) && empty( $password ) ) {		wp_send_json( [ 'error' => true, 'message' => 'پر کردن فیلد های زیر اجباری است!' ], 403 );	} elseif ( empty( $email ) ) {		wp_send_json( [ 'error' => true, 'message' => 'لطفا ایمیل خود را وارد کنید!' ], 403 );	} elseif ( empty( $password ) ) {		wp_send_json( [ 'error' => true, 'message' => 'لطفا پسورد خود را وارد کنید!' ], 403 );	}	if ( ! is_email( $email ) ) {		wp_send_json( [ 'error' => true, 'message' => 'لطفا ایمیل معتبر خود را وارد کنید!' ], 403 );	}}